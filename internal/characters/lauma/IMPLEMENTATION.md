# Lauma Character Implementation Summary

This document provides a comprehensive specification and implementation summary for the character "Lauma" in gcsim.

## Overview

Lauma is a 5-star Dendro catalyst character with unique mechanics revolving around resource management (Verdant Dew, Moon Song, Pale Hymn), reaction enhancements (Lunar-Bloom, Lunar-Charged), and party-wide buffs (Moonsign system). Her kit is designed to interact deeply with Bloom, Hyperbloom, Burgeon, and a custom reaction called Lunar-Bloom.

## Core Mechanics

### 1. Resource Management

- **Verdant Dew**: Stackable resource (max 3) gained by triggering Lunar-Bloom reactions. Consumed to enhance Elemental Skill (Hold).
- **Moon Song**: Stacks generated by using Hold Elemental Skill. Consumed by Elemental Burst for bonus Pale Hymn stacks.
- **Pale Hymn**: Buff stacks granted by Elemental Burst, enhancing reaction damage for a limited duration.

### 2. Moonsign System

- **Moonsign Nascent**: Activated when at least one party member has Moonsign. Grants Bloom reactions the ability to crit (15% CR, 100% CD).
- **Moonsign Ascendant**: Activated when three or more party members have Moonsign. Grants Lunar-Bloom reactions +10% CR, +20% CD.

### 3. Elemental Skill: Runo: Dawnless Rest of Karsikko

- **Press**: Deals AoE Dendro damage.
- **Hold**: Consumes Verdant Dew for enhanced damage and triggers Lunar-Bloom damage.
- **Frostgrove Sanctuary**: Creates a persistent DoT field, dealing periodic Dendro damage.
- **RES Reduction**: Applies Dendro/Hydro resistance reduction to enemies hit.

### 4. Elemental Burst: Nämä Laulut

- **Base Pale Hymn Stacks**: Grants 18 stacks, plus 6 per Moon Song stack consumed.
- **Reaction Buffs**: Increases damage of Bloom, Hyperbloom, Burgeon, and Lunar-Bloom reactions for the duration.
- **Moon Song Integration**: Consuming Moon Song stacks during Burst increases Pale Hymn stacks.

### 5. Passive Talents

- **A0 (Moonsign Benediction)**: Elemental Mastery increases Lunar-Bloom base damage (up to 14%).
- **A1 (Moonsign Buffs)**: Party-wide buffs based on Moonsign status.
- **A4**: Each point of Elemental Mastery increases Skill damage by 0.04% (max 32%).

### 6. Constellations

- **C1**: Lunar-Bloom reactions heal the party (500% EM scaling).
- **C2**: If Moonsign Ascendant is active during Burst, Lunar-Bloom damage is increased by 40%.
- **C4**: Frostgrove Sanctuary attacks restore 4 Energy (5s ICD).
- **C6**: Additional effects for Frostgrove attacks and Normal Attack conversion.

### 7. Lunar-Bloom Reaction

- **Trigger**: Occurs when Dendro and Hydro interact under specific conditions.
- **Effect**: Deals enhanced Dendro damage, generates Verdant Dew, and interacts with Moonsign buffs.

### 8. Lunar-Charged (LC) Reaction

- **Trigger**: Requires both Hydro and Electro auras on an enemy.
- **Effect**: Creates a thundercloud above the enemy for 6 seconds, dealing LC damage every 2 seconds.
- **Contributor System**: Tracks all characters who applied Hydro/Electro during LC. Damage is distributed based on contributor ranking.
- **Aura Expiry**: Contributors are removed when their aura expires.
- **Damage Calculation**: Highest contributor gets full damage, second gets half, third/fourth get 1/12, others get none.
- **CR Value**: Highest contributor's CR is used for the tick snapshot.

### 9. Technical Implementation

- **Resource Tracking**: Internal variables for Verdant Dew, Moon Song, Pale Hymn, Moonsign status.
- **Event System**: Monitors reactions, applies buffs, and schedules contributor removal.
- **Frame Data**: Accurate timings for all attacks, skills, and reactions.
- **Testing**: Scaling validation and build verification.

## Notes

- Damage scaling values are based on typical 5-star catalyst patterns.
- Some mechanics (e.g., precise Pale Hymn stack consumption) may require future refinement.
- Moonsign detection and buff application are simplified for simulation.
- C6 effects are partially implemented due to complexity.

## File Structure

- `lauma.go`: Main character struct and initialization.
- `lauma_gen.go`: Generated scaling values and data.
- `attack.go`: Normal attack implementation.
- `charge.go`: Charged attack implementation.
- `skill.go`: Elemental Skill implementation.
- `burst.go`: Elemental Burst implementation.
- `asc.go`: Ascension passives.
- `cons.go`: Constellation effects.
- `lauma_test.go`: Basic tests for scaling validation.